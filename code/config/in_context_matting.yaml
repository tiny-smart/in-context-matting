model:
  target: icm.models.in_context_matting_.InContextMatting
  params:
    cfg_feature_extractor:
      target: icm.dift.models.dift_sd.FeatureExtractor
      params:
        sd_id: "pretrained_models/stable-diffusion-2-1"
        load_local: True
        if_softmax: 1
        feature_index_cor: 1
        feature_index_matting: [0, 1]
        attention_res: [24, 48]
        set_diag_to_one: False
        time_steps: [200]
        extract_feature_inputted_to_layer: False
        ensemble_size: 4

    cfg_in_context_decoder:
      target: icm.models.decoder.in_context_decoder.InContextDecoder
      params:
        freeze_in_context_fusion: False
        cfg_detail_decoder:
          target: icm.models.decoder.detail_capture.DetailCapture
          params:
            use_sigmoid: True
            ckpt: ""
            in_chans: 320
            img_chans: 3
            convstream_out: [48, 96, 192]
            fusion_out: [256, 128, 64, 32]
        cfg_in_context_fusion:
          target: icm.models.decoder.in_context_correspondence.SemiTrainingAttentionBlocks
          params:
            res_ratio: null
            pool_type: "min"
            upsample_mode: "bicubic"
            bottle_neck_dim: null
            use_norm: 1280
            in_ft_dim: [1280, 1280]
            in_attn_dim: [576, 2304]
            attn_out_dim: 256
            ft_out_dim: [320, 320]
            training_cross_attn: False
